<!DOCTYPE html>
<html>
<head>
  <title>Audio Train</title>
</head>
<body>
  <p id="sentence">चिकन मोमोज़ हटा दो</p>
  <button id="recordButton">Record</button>
  <button id="doneButton" disabled>Done</button>

  <script>
    var audioChunks = [];
    var audioSentence = "चिकन मोमोज़ हटा दो";

    // Create a dictionary of the sentences
    var sentences = {};
    sentences["चिकन मोमोज़ चाहिए"] = true;
    sentences["मुझे चिकन मोमोज़ और एक आइस टी चाहिए"] = true;
    // ... (add the rest of your sentences here)

    navigator.mediaDevices.getUserMedia({ audio: true }).then(function (stream) {
      var mediaRecorder = new MediaRecorder(stream);
      mediaRecorder.ondataavailable = function (event) {
        audioChunks.push(event.data);
      };

      document.getElementById('recordButton').addEventListener('click', function () {
        mediaRecorder.start();
        document.getElementById('recordButton').disabled = true;
        document.getElementById('doneButton').disabled = false;
      });

      document.getElementById('doneButton').addEventListener('click', function () {
        mediaRecorder.stop();
        document.getElementById('recordButton').disabled = false;
        document.getElementById('doneButton').disabled = true;

        mediaRecorder.onstop = function () {
          var audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
          var reader = new FileReader();
          reader.readAsDataURL(audioBlob);
          reader.onloadend = function () {
            var audioData = reader.result;
            var sentence = audioSentence;

            // Send the audio and sentence to your GitHub Actions workflow
            sendAudioDataToGitHub(audioData, sentence);

            // Load the next sentence from the dictionary
            loadNextSentence();
          };
        };
      });
    });

    function loadNextSentence() {
      // Get the next sentence from the dictionary
      var nextSentence = Object.keys(sentences).find(function(sentence) {
        return sentences[sentence];
      });

      // Set the sentence to be recorded
      audioSentence = nextSentence;

      // Mark the sentence as recorded
      sentences[nextSentence] = false;

      // Update the UI to display the next sentence
      document.getElementById('sentence').textContent = audioSentence;
    }

    function sendAudioDataToGitHub(audioData, sentence) {
      fetch('https://YOUR_GITHUB_REPOSITORY_URL/contents/data.csv', {
        method: 'PUT',
        headers: {
          'Authorization': 'token ${{ secrets.GH_TOKEN }}', // Use your GitHub secret
          'Accept': 'application/vnd.github.v3+json',
        },
        body: JSON.stringify({
          message: 'Adding audio data',
          content: btoa(audioData), // Convert to base64
          branch: 'main',
        })
      })
      .then(response => {
        if (response.ok) {
          console.log('Data sent to GitHub Actions workflow successfully');
        } else {
          console.error('Failed to send data to GitHub Actions workflow');
        }
      })
      .catch(error => {
        console.error('Error:', error);
      });
    }
  </script>
</body>
</html>
